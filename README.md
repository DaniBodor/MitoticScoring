[![Awesome](https://cdn.rawgit.com/sindresorhus/awesome/d7305f38d29fed78fa85652e3a63e154dd8e8829/media/badge.svg)](https://github.com/sindresorhus/awesome)

# Mitotic Scoring Macro
This macro keeps track of manual scoring of mitotic events. It keeps track of timings, position, and potential mitotic errors or events.

Results are saved after each analyzed cell to avoid losing data after crashes or mistakes. Furthermore, previous progress can be loaded when re-running the macro for the same experiment so that you can stop in the middle of an analysis and carry on another time without losing track of where you were.

This macro is fairly uncomplicated and in principle will always tell you what to do. Below is a short explanation of the individual steps.  


## Start macro
Open the macro by any of these methods by dragging the \*.ijm file into FiJi and clicking 'Run' or hit Ctrl+R.  
Alternatively drop the \*.ijm file into your ImageJ plugins\Analyze folder and select it from _Plugins > Analyze_ dropdown menu 
(requires a restart after you first drop the file there).  
You can then also create a custom shortcut key via _Plugins > Shortcuts > Add Shortcut..._.

If there is currently no image file open, a window will pop up asking you to open a file.



## Setup
A dialog window will open to ask you for the settings for this experiment.
Here, you can set:
- the path where results are saved, the experiment name, and your time step
- settings regarding tracked cell boxes
    - whether or not to duplicate ROIs to the other half of the movie (e.g. useful for movies generated by the [OrgaMovie](https://github.com/DaniBodor/OrgaMovie) macro, where one organoid is displayed twice (left and right) with separate color coding)
    - the color of the box at the frame you specify as t0, t1, ...
    - the color of the box around the cell at all mitotic frames
- whether you want to keep track of mitotic events or only timing, and which mitotic stages you want to track
    - unchecking 'Score Observations' means you only keep track of times
    - at least one mitotic stage must be selected

Current settings will be stored and used as default next time you run the macro, so if nothing changes you can just click OK.

<img src="Images/Scoring_Macro_Setup.png" width=50%>


## Identify & score mitotic cells

The macro will ask you to draw a box around the mitotic cell at the for each stage selected in the settings. These boxes are used to visually keep track of which cells have already been analyzed.  
These boxes are saved in your save location after each analyzed cell, and are automatically reloaded when you restart the macro on the same cell.

Next, you will be prompted to input observations to track:  
<img src="Images/ObservationsChecklist.png" width=30%>

Then, results will be written to the scoring table, which is immediately saved (the file is overwritten after each cell) as a \*.csv, which can be read by most downstream applications (Excel, R, Python, Matlab, ...).
<img src="Images/ResultsTable.png" width=80%>

It then asks you to identify and box the next cell. This repeats forever, until you hit 'Esc' or in some other way quit the macro.

NOTE:  
**At any point you can close the image and open a different (or the same) one without crashing the macro or losing your progress. Also, you can quit the macro and carry on at a later time without losing your current progress.**

NOTE:  
**A problem would occur in the results table if you run the macro using the same experiment name but a different set of mitotic stages. If this happens, a warning will pop up asking you to either abort the current run or store the previous results table separately.  
If the macro continues running, the previous results table will be overwritten once the first cell is scored**




# TO DO LIST
- [x] Make z-plane boxes work properly
- [x] Allow for option to not have to click OK after drawing boxes
- [ ] Make option to rename mitotic stages
- [ ] Make option to rename observation items
- [ ] Link header writing and results outputting functions
  - [ ] move results outputting into function
- [ ] Use loops to fetch dialog info
  - this would make it 'modular' and easier to change in a single line
  - [ ] setup dialog
  - [ ] observation dialog
    - [ ] link this to header/results function
- [ ] Allow for changing of settings mid-experiment without screwing up results table
  - try using Table.* functions rather printing from array 
